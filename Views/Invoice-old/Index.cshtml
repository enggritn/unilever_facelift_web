
@{
    ViewBag.Title += " - List";
}


<div class="container-fluid">

    <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <h1 class="h3 mb-0 text-gray-800">@ViewBag.Title</h1>
    </div>

    <div class="row mb-3">
        <div class="col-lg-12">
            <button type="button" class="btn btn-success btn-icon-split" onclick="Create()">
                <span class="icon text-white-50">
                    <i class="fas fa-plus"></i>
                </span>
                <span class="text">New</span>
            </button>
            <button type="button" class="btn btn-secondary btn-icon-split" onclick="Refresh()">
                <span class="icon text-white-50">
                    <i class="fas fa-sync"></i>
                </span>
                <span class="text">Refresh</span>
            </button>
            @*<button type="button" class="btn btn-primary btn-icon-split" onclick="ExportExcel()">
                <span class="icon text-white-50">
                    <i class="fas fa-file-excel"></i>
                </span>
                <span class="text">Export Excel</span>
            </button>
            <button type="button" class="btn btn-primary btn-icon-split" onclick="ExportDetail()">
                <span class="icon text-white-50">
                    <i class="fas fa-file-excel"></i>
                </span>
                <span class="text">Export Detail</span>
            </button>*@
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <div class="card shadow mb-4 border-left-primary">
                @*<div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">Table</h6>
                    </div>*@
                <div class="card-body">
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="tab-1" data-toggle="tab" href="#tab1" role="tab" aria-controls="tab1" aria-selected="true">Used Pallet</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="tab-2" data-toggle="tab" href="#tab2" role="tab" aria-controls="tab2" aria-selected="false">Unused Pallet</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="tab-3" data-toggle="tab" href="#tab3" role="tab" aria-controls="tab3" aria-selected="false">Damage / Loss Pallet</a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="tab1" role="tabpanel" aria-labelledby="tab-1">
                            <div class="row mt-3 mb-3">
                                <div class="col-xs-12 col-lg-12">
                                    <div class="d-sm-flex align-items-center justify-content-between mb-1">
                                        <h5 class="h6 mb-0 text-gray-800">Used Pallet</h5>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-striped text-nowrap" id="table1" width="100%" cellspacing="0">
                                            <thead class="thead-dark">
                                                <tr>
                                                    <th>Transaction Code</th>
                                                    <th>Year</th>
                                                    <th>Month</th>
                                                    @*<th>Total Billing</th>*@
                                                    <th>Tax (%)</th>
                                                    @*<th>Total</th>*@
                                                    <th>Start Period</th>
                                                    <th>Last Period</th>
                                                    <th>Created By</th>
                                                    <th>Created At</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="tab2" role="tabpanel" aria-labelledby="tab-2">
                            <div class="row mt-3 mb-3">
                                <div class="col-xs-12 col-lg-12">
                                    <div class="d-sm-flex align-items-center justify-content-between mb-1">
                                        <h6 class="h6 mb-0 text-gray-800">Unused Pallet</h6>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-striped text-nowrap" id="table2" width="100%" cellspacing="0">
                                            <thead class="thead-dark">
                                                <tr>
                                                    <th>Transaction Code</th>
                                                    <th>Year</th>
                                                    <th>Month</th>
                                                    @*<th>Total Billing</th>*@
                                                    <th>Tax (%)</th>
                                                    @*<th>Total</th>*@
                                                    <th>Start Period</th>
                                                    <th>Last Period</th>
                                                    <th>Created By</th>
                                                    <th>Created At</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>

                                </div>
                            </div>

                        </div>

                        <div class="tab-pane fade" id="tab3" role="tabpanel" aria-labelledby="tab-3">
                            <div class="row mt-3 mb-3">
                                <div class="col-xs-12 col-lg-12">
                                    <div class="d-sm-flex align-items-center justify-content-between mb-1">
                                        <h6 class="h6 mb-0 text-gray-800">Damage / Loss Pallet</h6>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>


                </div>
            </div>

        </div>
    </div>

</div>


@section custom_css
{
    @Styles.Render("~/Content/vendor/datatables/dataTables.bootstrap4.min.css")
    @Styles.Render("~/Content/vendor/datatables/fixedColumns.bootstrap4.min.css")

    <style>
        th, td {
            white-space: nowrap;
        }

        div.dataTables_wrapper {
            /*width: 800px;*/
            margin: 0 auto;
        }
    </style>
}

@section custom_js
{
    @Scripts.Render("~/Content/vendor/datatables/jquery.dataTables.min.js")
    @Scripts.Render("~/Content/vendor/datatables/dataTables.bootstrap4.min.js")
    @Scripts.Render("~/Content/vendor/datatables/dataTables.fixedColumns.min.js")

<script>

        let billingType = "used";

        function Create() {
            location.href = '@Url.Action("Create")?type=' + billingType;
        }

        function Detail(id) {
            location.href = '@Url.Action("Detail")?type=' + billingType+ '&x=' + id;
        }

        function Refresh() {
            switch (billingType) {
                case "used":
                    table1.ajax.reload();
                    break;
                case "unused":
                    table2.ajax.reload();
                    break;
                case "accident":
                    break;
            }
        }

        $('#tab-1').on('shown.bs.tab', function (e) {
            billingType = "used";
            Refresh();
        });

        $('#tab-2').on('shown.bs.tab', function (e) {
            billingType = "unused";
            Refresh();
        });

        $('#tab-3').on('shown.bs.tab', function (e) {
            billingType = "accident";
            Refresh();
        });


        var table1 = $('#table1').DataTable({
                processing: true,
                serverSide: true,
                ajax: {
                    url: '@Url.Action("DatatableUsed")',
                    type: "POST",
                    datatype: "json"
                },
                scrollY: "500px",
                scrollX: true,
                scrollCollapse: true,
                paging: true,
                //fixedColumns: true
                fixedColumns: {
                    leftColumns: 1,
                    rightColumns: 1
                },
                columnDefs: [
                    { "orderable": false, "targets": -1 },
                ],
                order : [[0, "desc"]],
                columns: [
                     { "data": "TransactionCode", "name": "TransactionCode", "autoWidth": true },
                    { "data": "CurrentYear", "name": "CurrentYear", "autoWidth": true },
                    { "data": "CurrentMonth", "name": "CurrentMonth", "autoWidth": true },
                    { "data": "Tax", "name": "Tax", "autoWidth": true },
                    { "data": "StartPeriod", "name": "StartPeriod", "autoWidth": true },
                    { "data": "LastPeriod", "name": "LastPeriod", "autoWidth": true },
                    { "data": "CreatedBy", "name": "CreatedBy", "autoWidth": true },
                    { "data": "CreatedAt", "name": "CreatedAt", "autoWidth": true },
                    {
                        data: null,
                        render: function (data, type, row) {
                            let button = "<button type=\"button\" class=\"btn btn-sm btn-info btn-icon-split\" onclick=\"Detail('"+ row.TransactionId +"')\">";
                            button += '<span class="icon text-white-50"><i class="fas fa-edit"></i></span >';
                            button += '<span class="text">Detail</span></button >';
                            return button;
                        }
                    }
                ]
        });

        var table2 = $('#table2').DataTable({
                processing: true,
                serverSide: true,
                ajax: {
                    url: '@Url.Action("DatatableUnused")',
                    type: "POST",
                    datatype: "json"
                },
                scrollY: "500px",
                scrollX: true,
                scrollCollapse: true,
                paging: true,
                //fixedColumns: true
                fixedColumns: {
                    leftColumns: 1,
                    rightColumns: 1
                },
                columnDefs: [
                    { "orderable": false, "targets": -1 },
                ],
                order : [[0, "desc"]],
                columns: [
                     { "data": "TransactionCode", "name": "TransactionCode", "autoWidth": true },
                    { "data": "CurrentYear", "name": "CurrentYear", "autoWidth": true },
                    { "data": "CurrentMonth", "name": "CurrentMonth", "autoWidth": true },
                    { "data": "Tax", "name": "Tax", "autoWidth": true },
                    { "data": "StartPeriod", "name": "StartPeriod", "autoWidth": true },
                    { "data": "LastPeriod", "name": "LastPeriod", "autoWidth": true },
                    { "data": "CreatedBy", "name": "CreatedBy", "autoWidth": true },
                    { "data": "CreatedAt", "name": "CreatedAt", "autoWidth": true },
                    {
                        data: null,
                        render: function (data, type, row) {
                            let button = "<button type=\"button\" class=\"btn btn-sm btn-info btn-icon-split\" onclick=\"Detail('"+ row.TransactionId +"')\">";
                            button += '<span class="icon text-white-50"><i class="fas fa-edit"></i></span >';
                            button += '<span class="text">Detail</span></button >';
                            return button;
                        }
                    }
                ]
        });

        function ExportExcel() {
            window.location.href = '@Url.Action("ExportListToExcel", "Invoice")?type=' + billingType;
        }

        function ExportDetail() {
            window.location.href = '@Url.Action("ExportDetailListToExcel", "Invoice")?type=' + billingType;
        }


</script>

}